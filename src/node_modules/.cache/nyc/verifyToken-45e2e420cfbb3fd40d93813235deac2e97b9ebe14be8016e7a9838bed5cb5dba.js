function cov_ukr8mj5rc(){var path="/Users/robertpringle/Documents/GitHub/Individual-Project/src/routes/verifyToken.js";var hash="59f31fd16124df1fcc404e6f142d7b007f27c280";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/robertpringle/Documents/GitHub/Individual-Project/src/routes/verifyToken.js",statementMap:{"0":{start:{line:1,column:17},end:{line:1,column:40}},"1":{start:{line:4,column:0},end:{line:25,column:2}},"2":{start:{line:7,column:23},end:{line:7,column:47}},"3":{start:{line:8,column:22},end:{line:8,column:46}},"4":{start:{line:9,column:2},end:{line:9,column:82}},"5":{start:{line:9,column:37},end:{line:9,column:82}},"6":{start:{line:11,column:2},end:{line:24,column:3}},"7":{start:{line:13,column:4},end:{line:17,column:5}},"8":{start:{line:14,column:6},end:{line:14,column:77}},"9":{start:{line:16,column:6},end:{line:16,column:78}},"10":{start:{line:19,column:4},end:{line:19,column:29}},"11":{start:{line:20,column:4},end:{line:20,column:11}},"12":{start:{line:23,column:4},end:{line:23,column:46}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:4,column:17},end:{line:4,column:18}},loc:{start:{line:4,column:43},end:{line:25,column:1}},line:4}},branchMap:{"0":{loc:{start:{line:9,column:2},end:{line:9,column:82}},type:"if",locations:[{start:{line:9,column:2},end:{line:9,column:82}},{start:{line:9,column:2},end:{line:9,column:82}}],line:9},"1":{loc:{start:{line:9,column:6},end:{line:9,column:35}},type:"binary-expr",locations:[{start:{line:9,column:6},end:{line:9,column:19}},{start:{line:9,column:23},end:{line:9,column:35}}],line:9},"2":{loc:{start:{line:13,column:4},end:{line:17,column:5}},type:"if",locations:[{start:{line:13,column:4},end:{line:17,column:5}},{start:{line:13,column:4},end:{line:17,column:5}}],line:13}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},f:{"0":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"59f31fd16124df1fcc404e6f142d7b007f27c280"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_ukr8mj5rc=function(){return actualCoverage;};}return actualCoverage;}cov_ukr8mj5rc();const webtoken=(cov_ukr8mj5rc().s[0]++,require("jsonwebtoken"));//Backend functionality used to verify tokens to make sure sessions are valid
cov_ukr8mj5rc().s[1]++;module.exports=function(req,res,next){cov_ukr8mj5rc().f[0]++;var verifiedToken;const refreshToken=(cov_ukr8mj5rc().s[2]++,req.body['refreshToken']);const accessToken=(cov_ukr8mj5rc().s[3]++,req.cookies.access_token);cov_ukr8mj5rc().s[4]++;if((cov_ukr8mj5rc().b[1][0]++,!refreshToken)&&(cov_ukr8mj5rc().b[1][1]++,!accessToken)){cov_ukr8mj5rc().b[0][0]++;cov_ukr8mj5rc().s[5]++;return res.status(401).send("Access Denied");}else{cov_ukr8mj5rc().b[0][1]++;}cov_ukr8mj5rc().s[6]++;try{cov_ukr8mj5rc().s[7]++;if(accessToken){cov_ukr8mj5rc().b[2][0]++;cov_ukr8mj5rc().s[8]++;verifiedToken=webtoken.verify(accessToken,process.env.TOKEN_SECRET);}else{cov_ukr8mj5rc().b[2][1]++;cov_ukr8mj5rc().s[9]++;verifiedToken=webtoken.verify(refreshToken,process.env.TOKEN_SECRET);}cov_ukr8mj5rc().s[10]++;req.user=verifiedToken;cov_ukr8mj5rc().s[11]++;next();}catch(err){cov_ukr8mj5rc().s[12]++;res.status(400).send("Invalid Web Token");}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZlcmlmeVRva2VuLmpzIl0sIm5hbWVzIjpbIndlYnRva2VuIiwicmVxdWlyZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJyZXEiLCJyZXMiLCJuZXh0IiwidmVyaWZpZWRUb2tlbiIsInJlZnJlc2hUb2tlbiIsImJvZHkiLCJhY2Nlc3NUb2tlbiIsImNvb2tpZXMiLCJhY2Nlc3NfdG9rZW4iLCJzdGF0dXMiLCJzZW5kIiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIlRPS0VOX1NFQ1JFVCIsInVzZXIiLCJlcnIiXSwibWFwcGluZ3MiOiJpcEVBZVk7eUZBZlosS0FBTUEsQ0FBQUEsUUFBUSx5QkFBR0MsT0FBTyxDQUFDLGNBQUQsQ0FBVixDQUFkLENBRUE7dUJBQ0FDLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixTQUFVQyxHQUFWLENBQWVDLEdBQWYsQ0FBb0JDLElBQXBCLENBQTBCLHdCQUV6QyxHQUFJQyxDQUFBQSxhQUFKLENBQ0EsS0FBTUMsQ0FBQUEsWUFBWSx5QkFBR0osR0FBRyxDQUFDSyxJQUFKLENBQVMsY0FBVCxDQUFILENBQWxCLENBQ0EsS0FBTUMsQ0FBQUEsV0FBVyx5QkFBR04sR0FBRyxDQUFDTyxPQUFKLENBQVlDLFlBQWYsQ0FBakIsQ0FKeUMsdUJBS3pDLEdBQUksNEJBQUNKLFlBQUQsOEJBQWlCLENBQUNFLFdBQWxCLENBQUosQ0FBbUMsd0RBQU9MLENBQUFBLEdBQUcsQ0FBQ1EsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLGVBQXJCLENBQVAsQ0FBNkMsQ0FBaEYsZ0NBTHlDLHVCQU96QyxHQUFJLHdCQUVGLEdBQUlKLFdBQUosQ0FBZ0Isa0RBQ2RILGFBQWEsQ0FBR1AsUUFBUSxDQUFDZSxNQUFULENBQWdCTCxXQUFoQixDQUE2Qk0sT0FBTyxDQUFDQyxHQUFSLENBQVlDLFlBQXpDLENBQWhCLENBQ0QsQ0FGRCxJQUVPLGtEQUNMWCxhQUFhLENBQUdQLFFBQVEsQ0FBQ2UsTUFBVCxDQUFnQlAsWUFBaEIsQ0FBOEJRLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxZQUExQyxDQUFoQixDQUNELENBTkMsd0JBUUZkLEdBQUcsQ0FBQ2UsSUFBSixDQUFXWixhQUFYLENBUkUsd0JBU0ZELElBQUksR0FFTCxDQUFDLE1BQU9jLEdBQVAsQ0FBWSx5QkFDWmYsR0FBRyxDQUFDUSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUIsbUJBQXJCLEVBQ0QsQ0FDRixDQXJCRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHdlYnRva2VuID0gcmVxdWlyZShcImpzb253ZWJ0b2tlblwiKTtcblxuLy9CYWNrZW5kIGZ1bmN0aW9uYWxpdHkgdXNlZCB0byB2ZXJpZnkgdG9rZW5zIHRvIG1ha2Ugc3VyZSBzZXNzaW9ucyBhcmUgdmFsaWRcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHJlcSwgcmVzLCBuZXh0KSB7XG5cbiAgdmFyIHZlcmlmaWVkVG9rZW47XG4gIGNvbnN0IHJlZnJlc2hUb2tlbiA9IHJlcS5ib2R5WydyZWZyZXNoVG9rZW4nXVxuICBjb25zdCBhY2Nlc3NUb2tlbiA9IHJlcS5jb29raWVzLmFjY2Vzc190b2tlbjtcbiAgaWYgKCFyZWZyZXNoVG9rZW4gJiYgIWFjY2Vzc1Rva2VuKSByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLnNlbmQoXCJBY2Nlc3MgRGVuaWVkXCIpO1xuXG4gIHRyeSB7XG5cbiAgICBpZiAoYWNjZXNzVG9rZW4pe1xuICAgICAgdmVyaWZpZWRUb2tlbiA9IHdlYnRva2VuLnZlcmlmeShhY2Nlc3NUb2tlbiwgcHJvY2Vzcy5lbnYuVE9LRU5fU0VDUkVUKTsgXG4gICAgfSBlbHNlIHtcbiAgICAgIHZlcmlmaWVkVG9rZW4gPSB3ZWJ0b2tlbi52ZXJpZnkocmVmcmVzaFRva2VuLCBwcm9jZXNzLmVudi5UT0tFTl9TRUNSRVQpO1xuICAgIH1cblxuICAgIHJlcS51c2VyID0gdmVyaWZpZWRUb2tlbjtcbiAgICBuZXh0KCk7XG5cbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoXCJJbnZhbGlkIFdlYiBUb2tlblwiKTtcbiAgfVxufTtcbiJdfQ==