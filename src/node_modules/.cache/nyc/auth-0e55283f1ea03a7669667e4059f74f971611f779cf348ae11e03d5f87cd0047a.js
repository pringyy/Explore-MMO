function cov_104nsp5hwb(){var path="/Users/robertpringle/Documents/GitHub/Individual-Project/src/backend/routes/auth.js";var hash="d70f8c638cb05e47c87d96ffa814721e4adb06c3";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/robertpringle/Documents/GitHub/Individual-Project/src/backend/routes/auth.js",statementMap:{"0":{start:{line:1,column:16},end:{line:1,column:34}},"1":{start:{line:2,column:15},end:{line:2,column:42}},"2":{start:{line:3,column:13},end:{line:3,column:37}},"3":{start:{line:4,column:15},end:{line:4,column:34}},"4":{start:{line:5,column:17},end:{line:5,column:40}},"5":{start:{line:6,column:48},end:{line:6,column:72}},"6":{start:{line:8,column:24},end:{line:8,column:64}},"7":{start:{line:9,column:21},end:{line:9,column:53}},"8":{start:{line:11,column:18},end:{line:11,column:20}},"9":{start:{line:14,column:0},end:{line:57,column:4}},"10":{start:{line:16,column:20},end:{line:16,column:48}},"11":{start:{line:19,column:2},end:{line:22,column:60}},"12":{start:{line:20,column:4},end:{line:22,column:60}},"13":{start:{line:22,column:37},end:{line:22,column:46}},"14":{start:{line:25,column:24},end:{line:25,column:75}},"15":{start:{line:26,column:21},end:{line:26,column:66}},"16":{start:{line:29,column:2},end:{line:29,column:100}},"17":{start:{line:29,column:35},end:{line:29,column:100}},"18":{start:{line:30,column:2},end:{line:30,column:70}},"19":{start:{line:30,column:18},end:{line:30,column:70}},"20":{start:{line:31,column:2},end:{line:31,column:76}},"21":{start:{line:31,column:21},end:{line:31,column:76}},"22":{start:{line:34,column:15},end:{line:34,column:43}},"23":{start:{line:35,column:23},end:{line:35,column:69}},"24":{start:{line:38,column:15},end:{line:42,column:4}},"25":{start:{line:45,column:23},end:{line:47,column:4}},"26":{start:{line:50,column:2},end:{line:56,column:3}},"27":{start:{line:51,column:4},end:{line:51,column:22}},"28":{start:{line:52,column:6},end:{line:52,column:32}},"29":{start:{line:53,column:6},end:{line:53,column:27}},"30":{start:{line:55,column:4},end:{line:55,column:30}},"31":{start:{line:60,column:0},end:{line:109,column:4}},"32":{start:{line:62,column:20},end:{line:62,column:45}},"33":{start:{line:65,column:15},end:{line:65,column:66}},"34":{start:{line:67,column:2},end:{line:69,column:3}},"35":{start:{line:68,column:4},end:{line:68,column:66}},"36":{start:{line:72,column:24},end:{line:75,column:3}},"37":{start:{line:76,column:2},end:{line:76,column:82}},"38":{start:{line:76,column:22},end:{line:76,column:82}},"39":{start:{line:78,column:14},end:{line:82,column:2}},"40":{start:{line:85,column:16},end:{line:87,column:3}},"41":{start:{line:90,column:23},end:{line:92,column:4}},"42":{start:{line:95,column:2},end:{line:95,column:36}},"43":{start:{line:96,column:2},end:{line:96,column:41}},"44":{start:{line:99,column:2},end:{line:105,column:4}},"45":{start:{line:108,column:2},end:{line:108,column:53}},"46":{start:{line:112,column:0},end:{line:137,column:3}},"47":{start:{line:114,column:27},end:{line:114,column:35}},"48":{start:{line:116,column:2},end:{line:136,column:3}},"49":{start:{line:117,column:17},end:{line:121,column:5}},"50":{start:{line:124,column:18},end:{line:126,column:6}},"51":{start:{line:129,column:4},end:{line:129,column:38}},"52":{start:{line:130,column:4},end:{line:130,column:42}},"53":{start:{line:133,column:4},end:{line:133,column:36}},"54":{start:{line:135,column:4},end:{line:135,column:27}},"55":{start:{line:141,column:0},end:{line:158,column:3}},"56":{start:{line:143,column:2},end:{line:157,column:3}},"57":{start:{line:144,column:25},end:{line:144,column:49}},"58":{start:{line:145,column:4},end:{line:145,column:30}},"59":{start:{line:147,column:4},end:{line:154,column:5}},"60":{start:{line:148,column:6},end:{line:148,column:37}},"61":{start:{line:149,column:6},end:{line:149,column:36}},"62":{start:{line:150,column:6},end:{line:150,column:38}},"63":{start:{line:151,column:6},end:{line:151,column:54}},"64":{start:{line:153,column:6},end:{line:153,column:29}},"65":{start:{line:156,column:4},end:{line:156,column:27}},"66":{start:{line:161,column:0},end:{line:165,column:4}},"67":{start:{line:162,column:2},end:{line:164,column:5}},"68":{start:{line:163,column:6},end:{line:163,column:23}},"69":{start:{line:167,column:0},end:{line:167,column:24}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:14,column:40},end:{line:14,column:41}},loc:{start:{line:14,column:60},end:{line:57,column:1}},line:14},"1":{name:"(anonymous_1)",decl:{start:{line:22,column:30},end:{line:22,column:31}},loc:{start:{line:22,column:37},end:{line:22,column:46}},line:22},"2":{name:"(anonymous_2)",decl:{start:{line:60,column:37},end:{line:60,column:38}},loc:{start:{line:60,column:57},end:{line:109,column:1}},line:60},"3":{name:"(anonymous_3)",decl:{start:{line:112,column:22},end:{line:112,column:23}},loc:{start:{line:112,column:36},end:{line:137,column:1}},line:112},"4":{name:"(anonymous_4)",decl:{start:{line:141,column:23},end:{line:141,column:24}},loc:{start:{line:141,column:37},end:{line:158,column:1}},line:141},"5":{name:"(anonymous_5)",decl:{start:{line:161,column:45},end:{line:161,column:46}},loc:{start:{line:161,column:65},end:{line:165,column:1}},line:161},"6":{name:"(anonymous_6)",decl:{start:{line:162,column:50},end:{line:162,column:51}},loc:{start:{line:162,column:72},end:{line:164,column:3}},line:162}},branchMap:{"0":{loc:{start:{line:19,column:2},end:{line:22,column:60}},type:"if",locations:[{start:{line:19,column:2},end:{line:22,column:60}},{start:{line:19,column:2},end:{line:22,column:60}}],line:19},"1":{loc:{start:{line:29,column:2},end:{line:29,column:100}},type:"if",locations:[{start:{line:29,column:2},end:{line:29,column:100}},{start:{line:29,column:2},end:{line:29,column:100}}],line:29},"2":{loc:{start:{line:29,column:6},end:{line:29,column:33}},type:"binary-expr",locations:[{start:{line:29,column:6},end:{line:29,column:16}},{start:{line:29,column:20},end:{line:29,column:33}}],line:29},"3":{loc:{start:{line:30,column:2},end:{line:30,column:70}},type:"if",locations:[{start:{line:30,column:2},end:{line:30,column:70}},{start:{line:30,column:2},end:{line:30,column:70}}],line:30},"4":{loc:{start:{line:31,column:2},end:{line:31,column:76}},type:"if",locations:[{start:{line:31,column:2},end:{line:31,column:76}},{start:{line:31,column:2},end:{line:31,column:76}}],line:31},"5":{loc:{start:{line:67,column:2},end:{line:69,column:3}},type:"if",locations:[{start:{line:67,column:2},end:{line:69,column:3}},{start:{line:67,column:2},end:{line:69,column:3}}],line:67},"6":{loc:{start:{line:76,column:2},end:{line:76,column:82}},type:"if",locations:[{start:{line:76,column:2},end:{line:76,column:82}},{start:{line:76,column:2},end:{line:76,column:82}}],line:76},"7":{loc:{start:{line:116,column:2},end:{line:136,column:3}},type:"if",locations:[{start:{line:116,column:2},end:{line:136,column:3}},{start:{line:116,column:2},end:{line:136,column:3}}],line:116},"8":{loc:{start:{line:143,column:2},end:{line:157,column:3}},type:"if",locations:[{start:{line:143,column:2},end:{line:157,column:3}},{start:{line:143,column:2},end:{line:157,column:3}}],line:143},"9":{loc:{start:{line:147,column:4},end:{line:154,column:5}},type:"if",locations:[{start:{line:147,column:4},end:{line:154,column:5}},{start:{line:147,column:4},end:{line:154,column:5}}],line:147}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"d70f8c638cb05e47c87d96ffa814721e4adb06c3"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_104nsp5hwb=function(){return actualCoverage;};}return actualCoverage;}cov_104nsp5hwb();const express=(cov_104nsp5hwb().s[0]++,require("express"));const router=(cov_104nsp5hwb().s[1]++,require("express").Router());const User=(cov_104nsp5hwb().s[2]++,require("../model/user"));const bcrypt=(cov_104nsp5hwb().s[3]++,require("bcryptjs"));const webtoken=(cov_104nsp5hwb().s[4]++,require("jsonwebtoken"));const{registerValidation,loginValidation}=(cov_104nsp5hwb().s[5]++,require("../validation"));const asyncMiddleware=(cov_104nsp5hwb().s[6]++,require("../middleware/asyncMiddleware"));const userProgress=(cov_104nsp5hwb().s[7]++,require("../model/userProgress"));const tokenList=(cov_104nsp5hwb().s[8]++,{});//Backend functionality for registering
cov_104nsp5hwb().s[9]++;router.post("/register",asyncMiddleware(async(req,res)=>{cov_104nsp5hwb().f[0]++;const{error}=(cov_104nsp5hwb().s[10]++,registerValidation(req.body));//Sends error message if data is not valid
cov_104nsp5hwb().s[11]++;if(error){cov_104nsp5hwb().b[0][0]++;cov_104nsp5hwb().s[12]++;return res.status(400).send(error.details.map(x=>{cov_104nsp5hwb().f[1]++;cov_104nsp5hwb().s[13]++;return x.message;}).join(", "));}else{cov_104nsp5hwb().b[0][1]++;}//Checks if user details are already in the database
const usernameExist=(cov_104nsp5hwb().s[14]++,await User.findOne({username:req.body.username}));const emailExist=(cov_104nsp5hwb().s[15]++,await User.findOne({email:req.body.email}));//Returns required information to the user
cov_104nsp5hwb().s[16]++;if((cov_104nsp5hwb().b[2][0]++,emailExist)&&(cov_104nsp5hwb().b[2][1]++,usernameExist)){cov_104nsp5hwb().b[1][0]++;cov_104nsp5hwb().s[17]++;return res.status(400).send("Email and Username already exists");}else{cov_104nsp5hwb().b[1][1]++;}cov_104nsp5hwb().s[18]++;if(emailExist){cov_104nsp5hwb().b[3][0]++;cov_104nsp5hwb().s[19]++;return res.status(400).send("Email already exists");}else{cov_104nsp5hwb().b[3][1]++;}cov_104nsp5hwb().s[20]++;if(usernameExist){cov_104nsp5hwb().b[4][0]++;cov_104nsp5hwb().s[21]++;return res.status(400).send("Username already exists");}else{cov_104nsp5hwb().b[4][1]++;}//Hashes the password using Bcrypt
const salt=(cov_104nsp5hwb().s[22]++,await bcrypt.genSaltSync(10));const hashPassword=(cov_104nsp5hwb().s[23]++,await bcrypt.hashSync(req.body.password,salt));//Creates a new user
const user=(cov_104nsp5hwb().s[24]++,new User({username:req.body.username,email:req.body.email,password:hashPassword}));//Creates a new user a user progress record
const userprogress=(cov_104nsp5hwb().s[25]++,new userProgress({username:req.body.username}));//Tries to save the user to MongoDB
cov_104nsp5hwb().s[26]++;try{cov_104nsp5hwb().s[27]++;await user.save();cov_104nsp5hwb().s[28]++;await userprogress.save();cov_104nsp5hwb().s[29]++;res.status(200).send;}catch(err){cov_104nsp5hwb().s[30]++;res.status(400).send(err);}}));//Backend functionality for logging in
cov_104nsp5hwb().s[31]++;router.post("/login",asyncMiddleware(async(req,res)=>{cov_104nsp5hwb().f[2]++;const{error}=(cov_104nsp5hwb().s[32]++,loginValidation(req.body));//Checks if username exists
const user=(cov_104nsp5hwb().s[33]++,await User.findOne({username:req.body.username}));cov_104nsp5hwb().s[34]++;if(!user){cov_104nsp5hwb().b[5][0]++;cov_104nsp5hwb().s[35]++;return res.status(400).send("Incorrect username or password");}else{cov_104nsp5hwb().b[5][1]++;}//Checks if passwords match
const validPassword=(cov_104nsp5hwb().s[36]++,await bcrypt.compare(req.body.password,user.password));cov_104nsp5hwb().s[37]++;if(!validPassword){cov_104nsp5hwb().b[6][0]++;cov_104nsp5hwb().s[38]++;return res.status(400).send("Invalid username or password");}else{cov_104nsp5hwb().b[6][1]++;}const body=(cov_104nsp5hwb().s[39]++,{_id:user._id,email:user.email,username:user.username});//Creates and signs a JSON webtoken
const token=(cov_104nsp5hwb().s[40]++,webtoken.sign({info:body},process.env.TOKEN_SECRET,{expiresIn:300}));//Creates and signs a refresh JSON token
const refreshToken=(cov_104nsp5hwb().s[41]++,webtoken.sign({info:body},process.env.TOKEN_SECRET,{expiresIn:10000}));//Creates cookies for session validation
cov_104nsp5hwb().s[42]++;res.cookie("access_token",token);cov_104nsp5hwb().s[43]++;res.cookie("refreshJwt",refreshToken);//Stores a new token in memory
cov_104nsp5hwb().s[44]++;tokenList[refreshToken]={token,refreshToken,email:user.email,_id:user._id,username:user.username};//sends the cookies to the user
cov_104nsp5hwb().s[45]++;return res.status(200).json({token,refreshToken});}));//Backend functionality for updating tokens
cov_104nsp5hwb().s[46]++;router.post("/token",(req,res)=>{cov_104nsp5hwb().f[3]++;const{refreshToken}=(cov_104nsp5hwb().s[47]++,req.body);cov_104nsp5hwb().s[48]++;if(refreshToken in tokenList){cov_104nsp5hwb().b[7][0]++;const body=(cov_104nsp5hwb().s[49]++,{email:tokenList[refreshToken].email,_id:tokenList[refreshToken]._id,username:tokenList[refreshToken].username});//Signs the new JSON webtoken
const token=(cov_104nsp5hwb().s[50]++,webtoken.sign({info:body},process.env.TOKEN_SECRET,{expiresIn:300}));//Update the JSON webtoken
cov_104nsp5hwb().s[51]++;res.cookie("access_token",token);cov_104nsp5hwb().s[52]++;tokenList[refreshToken].token=token;//Sends updated JSON webtoken to the user
cov_104nsp5hwb().s[53]++;res.status(200).json({token});}else{cov_104nsp5hwb().b[7][1]++;cov_104nsp5hwb().s[54]++;res.status(401).json();}});//Backend functionality for logging a user out
cov_104nsp5hwb().s[55]++;router.post("/logout",(req,res)=>{cov_104nsp5hwb().f[4]++;cov_104nsp5hwb().s[56]++;if(req.cookies){cov_104nsp5hwb().b[8][0]++;const refreshToken=(cov_104nsp5hwb().s[57]++,req.body['refreshToken']);cov_104nsp5hwb().s[58]++;console.log(refreshToken);cov_104nsp5hwb().s[59]++;if(refreshToken in tokenList){cov_104nsp5hwb().b[9][0]++;cov_104nsp5hwb().s[60]++;delete tokenList[refreshToken];cov_104nsp5hwb().s[61]++;res.clearCookie("refreshJwt");cov_104nsp5hwb().s[62]++;res.clearCookie("access_token");cov_104nsp5hwb().s[63]++;res.status(200).json({message:"logged out"});}else{cov_104nsp5hwb().b[9][1]++;cov_104nsp5hwb().s[64]++;res.status(401).json();}}else{cov_104nsp5hwb().b[8][1]++;cov_104nsp5hwb().s[65]++;res.status(401).json();}});//Backend functionality for deleting an account for testing purposes
cov_104nsp5hwb().s[66]++;router.post("/deleteAccount",asyncMiddleware(async(req,res)=>{cov_104nsp5hwb().f[5]++;cov_104nsp5hwb().s[67]++;User.deleteOne({username:req.body.username},function(err,result){cov_104nsp5hwb().f[6]++;cov_104nsp5hwb().s[68]++;res.send(result);});}));cov_104nsp5hwb().s[69]++;module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGguanMiXSwibmFtZXMiOlsiZXhwcmVzcyIsInJlcXVpcmUiLCJyb3V0ZXIiLCJSb3V0ZXIiLCJVc2VyIiwiYmNyeXB0Iiwid2VidG9rZW4iLCJyZWdpc3RlclZhbGlkYXRpb24iLCJsb2dpblZhbGlkYXRpb24iLCJhc3luY01pZGRsZXdhcmUiLCJ1c2VyUHJvZ3Jlc3MiLCJ0b2tlbkxpc3QiLCJwb3N0IiwicmVxIiwicmVzIiwiZXJyb3IiLCJib2R5Iiwic3RhdHVzIiwic2VuZCIsImRldGFpbHMiLCJtYXAiLCJ4IiwibWVzc2FnZSIsImpvaW4iLCJ1c2VybmFtZUV4aXN0IiwiZmluZE9uZSIsInVzZXJuYW1lIiwiZW1haWxFeGlzdCIsImVtYWlsIiwic2FsdCIsImdlblNhbHRTeW5jIiwiaGFzaFBhc3N3b3JkIiwiaGFzaFN5bmMiLCJwYXNzd29yZCIsInVzZXIiLCJ1c2VycHJvZ3Jlc3MiLCJzYXZlIiwiZXJyIiwidmFsaWRQYXNzd29yZCIsImNvbXBhcmUiLCJfaWQiLCJ0b2tlbiIsInNpZ24iLCJpbmZvIiwicHJvY2VzcyIsImVudiIsIlRPS0VOX1NFQ1JFVCIsImV4cGlyZXNJbiIsInJlZnJlc2hUb2tlbiIsImNvb2tpZSIsImpzb24iLCJjb29raWVzIiwiY29uc29sZSIsImxvZyIsImNsZWFyQ29va2llIiwiZGVsZXRlT25lIiwicmVzdWx0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6ImdqUUFlWTsyRkFmWixLQUFNQSxDQUFBQSxPQUFPLDBCQUFHQyxPQUFPLENBQUMsU0FBRCxDQUFWLENBQWIsQ0FDQSxLQUFNQyxDQUFBQSxNQUFNLDBCQUFHRCxPQUFPLENBQUMsU0FBRCxDQUFQLENBQW1CRSxNQUFuQixFQUFILENBQVosQ0FDQSxLQUFNQyxDQUFBQSxJQUFJLDBCQUFHSCxPQUFPLENBQUMsZUFBRCxDQUFWLENBQVYsQ0FDQSxLQUFNSSxDQUFBQSxNQUFNLDBCQUFHSixPQUFPLENBQUMsVUFBRCxDQUFWLENBQVosQ0FDQSxL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dCBleHByZXNzID0gcmVxdWlyZShcImV4cHJlc3NcIik7XHJcbmNvbnN0IHJvdXRlciA9IHJlcXVpcmUoXCJleHByZXNzXCIpLlJvdXRlcigpO1xyXG5jb25zdCBVc2VyID0gcmVxdWlyZShcIi4uL21vZGVsL3VzZXJcIik7XHJcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoXCJiY3J5cHRqc1wiKTtcclxuY29uc3Qgd2VidG9rZW4gPSByZXF1aXJlKFwianNvbndlYnRva2VuXCIpO1xyXG5jb25zdCB7IHJlZ2lzdGVyVmFsaWRhdGlvbiwgbG9naW5WYWxpZGF0aW9uIH0gPSByZXF1aXJlKFwiLi4vdmFsaWRhdGlvblwiKTtcclxuXHJcbmNvbnN0IGFzeW5jTWlkZGxld2FyZSA9IHJlcXVpcmUoXCIuLi9taWRkbGV3YXJlL2FzeW5jTWlkZGxld2FyZVwiKTtcclxuY29uc3QgdXNlclByb2dyZXNzID0gcmVxdWlyZShcIi4uL21vZGVsL3VzZXJQcm9ncmVzc1wiKTtcclxuXHJcbmNvbnN0IHRva2VuTGlzdCA9IHt9O1xyXG5cclxuLy9CYWNrZW5kIGZ1bmN0aW9uYWxpdHkgZm9yIHJlZ2lzdGVyaW5nXHJcbnJvdXRlci5wb3N0KFwiL3JlZ2lzdGVyXCIsYXN5bmNNaWRkbGV3YXJlKGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgXHJcbiAgY29uc3QgeyBlcnJvciB9ID0gcmVnaXN0ZXJWYWxpZGF0aW9uKHJlcS5ib2R5KTtcclxuXHJcbiAgLy9TZW5kcyBlcnJvciBtZXNzYWdlIGlmIGRhdGEgaXMgbm90IHZhbGlkXHJcbiAgaWYgKGVycm9yKVxyXG4gICAgcmV0dXJuIHJlc1xyXG4gICAgICAuc3RhdHVzKDQwMClcclxuICAgICAgLnNlbmQoZXJyb3IuZGV0YWlscy5tYXAoKHgpID0+IHgubWVzc2FnZSkuam9pbihcIiwgXCIpKTtcclxuXHJcbiAgLy9DaGVja3MgaWYgdXNlciBkZXRhaWxzIGFyZSBhbHJlYWR5IGluIHRoZSBkYXRhYmFzZVxyXG4gIGNvbnN0IHVzZXJuYW1lRXhpc3QgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyB1c2VybmFtZTogcmVxLmJvZHkudXNlcm5hbWUgfSk7XHJcbiAgY29uc3QgZW1haWxFeGlzdCA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IGVtYWlsOiByZXEuYm9keS5lbWFpbCB9KTtcclxuXHJcbiAgLy9SZXR1cm5zIHJlcXVpcmVkIGluZm9ybWF0aW9uIHRvIHRoZSB1c2VyXHJcbiAgaWYgKGVtYWlsRXhpc3QgJiYgdXNlcm5hbWVFeGlzdCkgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKFwiRW1haWwgYW5kIFVzZXJuYW1lIGFscmVhZHkgZXhpc3RzXCIpO1xyXG4gIGlmIChlbWFpbEV4aXN0KSByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoXCJFbWFpbCBhbHJlYWR5IGV4aXN0c1wiKTtcclxuICBpZiAodXNlcm5hbWVFeGlzdCkgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKFwiVXNlcm5hbWUgYWxyZWFkeSBleGlzdHNcIik7XHJcblxyXG4gIC8vSGFzaGVzIHRoZSBwYXNzd29yZCB1c2luZyBCY3J5cHRcclxuICBjb25zdCBzYWx0ID0gYXdhaXQgYmNyeXB0LmdlblNhbHRTeW5jKDEwKTtcclxuICBjb25zdCBoYXNoUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaFN5bmMocmVxLmJvZHkucGFzc3dvcmQsIHNhbHQpO1xyXG5cclxuICAvL0NyZWF0ZXMgYSBuZXcgdXNlclxyXG4gIGNvbnN0IHVzZXIgPSBuZXcgVXNlcih7XHJcbiAgICB1c2VybmFtZTogcmVxLmJvZHkudXNlcm5hbWUsXHJcbiAgICBlbWFpbDogcmVxLmJvZHkuZW1haWwsXHJcbiAgICBwYXNzd29yZDogaGFzaFBhc3N3b3JkLFxyXG4gIH0pO1xyXG5cclxuICAvL0NyZWF0ZXMgYSBuZXcgdXNlciBhIHVzZXIgcHJvZ3Jlc3MgcmVjb3JkXHJcbiAgY29uc3QgdXNlcnByb2dyZXNzID0gbmV3IHVzZXJQcm9ncmVzcyh7XHJcbiAgICB1c2VybmFtZTogcmVxLmJvZHkudXNlcm5hbWUsXHJcbiAgfSk7XHJcblxyXG4gIC8vVHJpZXMgdG8gc2F2ZSB0aGUgdXNlciB0byBNb25nb0RCXHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IHVzZXIuc2F2ZSgpOyAgXHJcbiAgICAgIGF3YWl0IHVzZXJwcm9ncmVzcy5zYXZlKCk7IFxyXG4gICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZDtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGVycik7XHJcbiAgfVxyXG59KSk7XHJcblxyXG4vL0JhY2tlbmQgZnVuY3Rpb25hbGl0eSBmb3IgbG9nZ2luZyBpblxyXG5yb3V0ZXIucG9zdChcIi9sb2dpblwiLGFzeW5jTWlkZGxld2FyZShhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgIFxyXG4gIGNvbnN0IHsgZXJyb3IgfSA9IGxvZ2luVmFsaWRhdGlvbihyZXEuYm9keSk7XHJcblxyXG4gIC8vQ2hlY2tzIGlmIHVzZXJuYW1lIGV4aXN0c1xyXG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyB1c2VybmFtZTogcmVxLmJvZHkudXNlcm5hbWUgfSk7XHJcblxyXG4gIGlmICghdXNlcikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKFwiSW5jb3JyZWN0IHVzZXJuYW1lIG9yIHBhc3N3b3JkXCIpO1xyXG4gIH1cclxuXHJcbiAgLy9DaGVja3MgaWYgcGFzc3dvcmRzIG1hdGNoXHJcbiAgY29uc3QgdmFsaWRQYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKFxyXG4gICAgcmVxLmJvZHkucGFzc3dvcmQsXHJcbiAgICB1c2VyLnBhc3N3b3JkXHJcbiAgKTtcclxuICBpZiAoIXZhbGlkUGFzc3dvcmQpIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChcIkludmFsaWQgdXNlcm5hbWUgb3IgcGFzc3dvcmRcIik7XHJcblx0ICBcclxuXHRjb25zdCBib2R5ID0ge1xyXG5cdFx0X2lkOiB1c2VyLl9pZCxcclxuXHRcdGVtYWlsOiB1c2VyLmVtYWlsLFxyXG5cdFx0dXNlcm5hbWU6IHVzZXIudXNlcm5hbWUsXHJcblx0fTtcclxuXHJcbiAgLy9DcmVhdGVzIGFuZCBzaWducyBhIEpTT04gd2VidG9rZW5cclxuICBjb25zdCB0b2tlbiA9IHdlYnRva2VuLnNpZ24oe2luZm86IGJvZHl9LCBwcm9jZXNzLmVudi5UT0tFTl9TRUNSRVQsIHtcclxuICAgIGV4cGlyZXNJbjogMzAwLFxyXG5cdH0pO1xyXG4gIFxyXG4gIC8vQ3JlYXRlcyBhbmQgc2lnbnMgYSByZWZyZXNoIEpTT04gdG9rZW5cclxuICBjb25zdCByZWZyZXNoVG9rZW4gPSB3ZWJ0b2tlbi5zaWduKHtpbmZvOiBib2R5fSwgcHJvY2Vzcy5lbnYuVE9LRU5fU0VDUkVULCB7IFxyXG4gICAgZXhwaXJlc0luOiAxMDAwMCBcclxuICB9KTtcclxuXHJcbiAgLy9DcmVhdGVzIGNvb2tpZXMgZm9yIHNlc3Npb24gdmFsaWRhdGlvblxyXG4gIHJlcy5jb29raWUoXCJhY2Nlc3NfdG9rZW5cIiwgdG9rZW4pO1xyXG4gIHJlcy5jb29raWUoXCJyZWZyZXNoSnd0XCIsIHJlZnJlc2hUb2tlbik7XHJcblxyXG4gIC8vU3RvcmVzIGEgbmV3IHRva2VuIGluIG1lbW9yeVxyXG4gIHRva2VuTGlzdFtyZWZyZXNoVG9rZW5dID0ge1xyXG4gICAgdG9rZW4sXHJcbiAgICByZWZyZXNoVG9rZW4sXHJcbiAgICBlbWFpbDogdXNlci5lbWFpbCxcclxuICAgIF9pZDogdXNlci5faWQsXHJcbiAgICB1c2VybmFtZTogdXNlci51c2VybmFtZSxcclxuICB9O1xyXG5cclxuICAvL3NlbmRzIHRoZSBjb29raWVzIHRvIHRoZSB1c2VyXHJcbiAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHt0b2tlbiwgcmVmcmVzaFRva2VufSk7XHJcbn0pKTtcclxuXHJcbi8vQmFja2VuZCBmdW5jdGlvbmFsaXR5IGZvciB1cGRhdGluZyB0b2tlbnNcclxucm91dGVyLnBvc3QoXCIvdG9rZW5cIiwgKHJlcSwgcmVzKSA9PiB7XHJcblxyXG4gIGNvbnN0IHsgcmVmcmVzaFRva2VuIH0gPSByZXEuYm9keTtcclxuXHJcbiAgaWYgKHJlZnJlc2hUb2tlbiBpbiB0b2tlbkxpc3QpIHtcclxuICAgIGNvbnN0IGJvZHkgPSB7XHJcbiAgICAgIGVtYWlsOiB0b2tlbkxpc3RbcmVmcmVzaFRva2VuXS5lbWFpbCxcclxuICAgICAgX2lkOiB0b2tlbkxpc3RbcmVmcmVzaFRva2VuXS5faWQsXHJcbiAgICAgIHVzZXJuYW1lOiB0b2tlbkxpc3RbcmVmcmVzaFRva2VuXS51c2VybmFtZSxcclxuICAgIH07XHJcblxyXG4gICAgLy9TaWducyB0aGUgbmV3IEpTT04gd2VidG9rZW5cclxuICAgIGNvbnN0IHRva2VuID0gd2VidG9rZW4uc2lnbih7aW5mbzogYm9keX0sIHByb2Nlc3MuZW52LlRPS0VOX1NFQ1JFVCwge1xyXG4gICAgICBleHBpcmVzSW46IDMwMCxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vVXBkYXRlIHRoZSBKU09OIHdlYnRva2VuXHJcbiAgICByZXMuY29va2llKFwiYWNjZXNzX3Rva2VuXCIsIHRva2VuKTtcclxuICAgIHRva2VuTGlzdFtyZWZyZXNoVG9rZW5dLnRva2VuID0gdG9rZW47XHJcblxyXG4gICAgLy9TZW5kcyB1cGRhdGVkIEpTT04gd2VidG9rZW4gdG8gdGhlIHVzZXJcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgdG9rZW4gfSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKCk7XHJcbiAgfVxyXG59KTtcclxuXHJcblxyXG4vL0JhY2tlbmQgZnVuY3Rpb25hbGl0eSBmb3IgbG9nZ2luZyBhIHVzZXIgb3V0XHJcbnJvdXRlci5wb3N0KFwiL2xvZ291dFwiLCAocmVxLCByZXMpID0+IHtcclxuXHJcbiAgaWYgKHJlcS5jb29raWVzKSB7XHJcbiAgICBjb25zdCByZWZyZXNoVG9rZW4gPSByZXEuYm9keVsncmVmcmVzaFRva2VuJ107XHJcbiAgICBjb25zb2xlLmxvZyhyZWZyZXNoVG9rZW4pO1xyXG5cclxuICAgIGlmIChyZWZyZXNoVG9rZW4gaW4gdG9rZW5MaXN0KSB7XHJcbiAgICAgIGRlbGV0ZSB0b2tlbkxpc3RbcmVmcmVzaFRva2VuXTsgXHJcbiAgICAgIHJlcy5jbGVhckNvb2tpZShcInJlZnJlc2hKd3RcIik7XHJcbiAgICAgIHJlcy5jbGVhckNvb2tpZShcImFjY2Vzc190b2tlblwiKTtcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiBcImxvZ2dlZCBvdXRcIiB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKCk7XHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKCk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vQmFja2VuZCBmdW5jdGlvbmFsaXR5IGZvciBkZWxldGluZyBhbiBhY2NvdW50IGZvciB0ZXN0aW5nIHB1cnBvc2VzXHJcbnJvdXRlci5wb3N0KFwiL2RlbGV0ZUFjY291bnRcIixhc3luY01pZGRsZXdhcmUoYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgVXNlci5kZWxldGVPbmUoeyB1c2VybmFtZTogcmVxLmJvZHkudXNlcm5hbWUgfSwgZnVuY3Rpb24oZXJyLCByZXN1bHQpIHtcclxuICAgICAgcmVzLnNlbmQocmVzdWx0KTtcclxuICB9KTtcclxufSkpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7XHJcbiJdfQ==